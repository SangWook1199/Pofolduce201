<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layouts/layout}">
<head>

<link th:href="@{/css/board-header.css}" rel="stylesheet">
<link rel="stylesheet" th:href="@{/css/page-css/mypage-menu.css}" />
<link rel="stylesheet" th:href="@{/css/page-css/mypage-main.css}" />

<title>마이페이지</title>
</head>

<div layout:fragment="content">
	<div class="mypage">
		<div class="mypage-main">
			<div
				th:replace="fragments/html/board-header :: board-header('마이페이지')"></div>
			<div class="mypage-main-side">
				<div th:replace="fragments/html/mypage-menu :: mypage-menu"></div>
				<div>

					<div class="mypage-main-container">
						<h1 id="mypage-title2">내 정보</h1>
						<div class="box">
							<div id="person-svg">
								<div th:if="${hasProfileImage}">
									<img th:src="@{|/uploads/profile/${userData.userId}.png|}"
										style="object-fit: cover" />
								</div>
								<div th:if="${!hasProfileImage}">
									<img th:src="@{/svg/person.svg}" width="130" height="130">
								</div>

							</div>

						</div>
						<div class="box-left">
							<!-- 사진 업로드 폼 및 버튼 -->

							<input type="hidden" name="userId">

							<button type="button" class="btn btn-outline-primary btn-custom"
								data-bs-toggle="modal" data-bs-target="#globalModal"
								data-modal-title="프로필 사진 변경"
								data-modal-body='
							<form id="updateProfileForm" action="/mypage/profile"
								method="POST" enctype="multipart/form-data" >
								<div class="input-group mb-3">
  								<input type="file" class="form-control" id="updateProfile" name="file" accept=".jpg,.jpeg,.png" >
								</div>
								</form>
								'
								data-modal-confirm="사진 변경">사진 변경</button>
						</div>
					</div>

					<div class="mypage-main-container">

						<div class="mypage-main-info">
							<div class="mypage-main-info-box">
								<h2 id="id-box">닉네임</h2>
								<h2 id="id-box">이메일</h2>
								<h2 id="id-box">회사 인증</h2>
								<h2 id="id-box">등급</h2>

							</div>


							<form class="mypage-main-info-box" id="userinfo"
								action="/mypage/update" method="POST">
								<div class="input-icon nickname">
									<input class="input" type="text"
										th:value="${userData.nickname}" id="nickname" name="nickname"
										disabled> <img class="pen-svg"
										th:src="@{/svg/pen.svg}">
								</div>

								<div class="input-icon">
									<input class="input" type="text" th:value="${userData.email}"
										id="email" name="email" disabled> <img class="pen-svg"
										th:src="@{/svg/pen.svg}">

								</div>
								<div class="verify-box button">

									<input type="hidden" name="userId">
									<div id="verification"
										th:style="${userData.companyCertification == 'no'} ? 'display:inline-block;' : 'display:none;'">
										<button type="button"
											class="btn btn-outline-primary btn-custom2"
											data-bs-toggle="modal" data-bs-target="#globalModal"
											data-modal-title="회사 인증하기"
											data-modal-body='
							<form id="updateCompanyForm" action="/mypage/company"
								method="POST" enctype="multipart/form-data" >
								<div class="input-group mb-3">
								<input type="text" class="company-input" id="updateCompanyName" name ="company" >
  								<input type="file" class="form-control" id="updateCompany" name="file" accept=".jpg,.jpeg,.png" >
								</div>
								</form>
								'
											data-modal-confirm="인증 전송"
												th:text="${userCompanyData != null 
          ? (userCompanyData.state == '대기' ? '인증 대기중' 
             : (userCompanyData.state == '반려' ? '인증 반려' : '인증 하기')) 
          : '인증 하기'}">인증버튼</button>

									</div>
									<div class="verify-box" type="text" id="company-name"
										th:if="${userData.companyCertification =='yes'}"
										th:text="${userData.companyName}">인증 완료</div>


								</div>




								<div class="verify-box" type="text"
									th:text="${userData.point >= 10000 ? '아이돌' :
               (userData.point >= 2000 ? '데뷔조' :
               (userData.point >= 1000 ? '연습생 A' :
               (userData.point >= 500 ? '연습생 B' :
               (userData.point >= 100 ? '연습생 C' : '연습생 D'))))}">
								</div>

							</form>


						</div>
						<div class="box-left">
							<button type="submit" class="btn btn-outline-primary btn-custom"
								id="btn-box">정보 수정</button>

							<!-- 탈퇴용 숨은 폼 -->
							<form id="deleteForm" action="/mypage/delete" method="POST"
								style="display: none;"></form>
							<input type="hidden" name="userId" value="123">

							<button type="button" id="deleteBtn"
								class="btn btn-outline-primary btn-custom"
								data-bs-toggle="modal" data-bs-target="#globalModal"
								data-modal-title="회원 탈퇴" data-modal-body="정말 탈퇴하시겠습니까?"
								data-modal-confirm="탈퇴하기">회원 탈퇴</button>


						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>



<script
	src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>



<div layout:fragment="script">
	<script th:src="@{/js/modal.js}"></script>
	<script th:src="@{/js/mypage.js}"></script>
</div>

</html>